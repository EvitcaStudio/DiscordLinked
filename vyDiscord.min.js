(()=>{const DISCORD_OAUTH2_BASE_URL="https://discordapp.com/api/oauth2/authorize",DISCORD_OAUTH2_TOKEN_BASE_URL="https://discordapp.com/api/oauth2/token",DISCORD_USERS_BASE_URL="https://discordapp.com/api/users/@me",DISCORD_AVATAR_BASE_URL="https://cdn.discordapp.com/avatars/",REDIRECT_URI=encodeURIComponent(window.location.href.replace("localhost","127.0.0.1").split("?")[0]),DISCORD_IMAGE_WIDTH=128,DISCORD_IMAGE_HEIGHT=128,CLIENT_ID="",CLIENT_SECRET="",NETWORK=!1,canvas=document.createElement("canvas"),ctx=canvas.getContext("2d"),image=new Image;image.crossOrigin="anonymous",canvas.width=128,canvas.height=128;class VYDiscordUser{constructor(pUserObject){this.userObject=pUserObject}getID(){return this.userObject.id}getUserName(){return this.userObject.username}getAvatar(){return this.userObject.avatar}getBanner(){return this.userObject.banner_color}getBannerColor(){return this.userObject.banner_color}getAccentColor(){return this.userObject.accent_color}getNitro(){return this.userObject.premium_type}get2FA(){return this.userObject.mfa_enabled}getTag(){return this.userObject.discriminator}getPublicFlags(){return this.userObject.public_flags}isBot(){return this.userObject.bot}isVerfied(){return this.userObject.verified}avatarToBase64(pWidth,pHeight,pCallback){image.src=DISCORD_AVATAR_BASE_URL+this.getID()+"/"+this.getAvatar(),canvas.width=pWidth,canvas.height=pHeight,image.addEventListener("load",e=>{ctx.drawImage(image,0,0,pWidth,pHeight);const dataURL=canvas.toDataURL();ctx.clearRect(0,0,canvas.width,canvas.height),canvas.width=128,canvas.height=128,pCallback(dataURL,pWidth,pHeight)})}createDiscordAvii(pWidth=128,pHeight=128,pCallback){const self=this;this.avatarToBase64(pWidth,pHeight,(pDataURL,pWidth,pHeight)=>{const id=self.getID();VYLO&&VYLO.Icon.newAtlas(id),VYLO&&VYLO.Icon.newIcon(id,"avii",pWidth,pHeight),VYLO&&VYLO.Icon.setDataURL(pDataURL,id,"avii",null,null,pCallback)})}}class VYDiscordHandler{getURIParams(){const currentURL=window.location.href.split("?")[1],searchParams=new URLSearchParams(currentURL);return searchParams}login(){this.getCode()?this.grabUserToken():window.location.assign(DISCORD_OAUTH2_BASE_URL+"?client_id=&redirect_uri="+REDIRECT_URI+"&response_type=code&scope=identify&prompt=none")}getCode(){const code=this.getURIParams().get("code");return code}grabDiscordUser(pToken){const xhttp=new XMLHttpRequest,xhrData={Bearer:pToken.access_token};xhttp.open("GET",DISCORD_USERS_BASE_URL,!0),xhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded"),xhttp.setRequestHeader("Authorization","Bearer "+pToken.access_token),xhttp.send(xhrData),xhttp.onloadend=()=>{const userObject=JSON.parse(xhttp.responseText),DiscordUser=new VYDiscordUser(userObject);window.DiscordUser=DiscordUser,VYLO&&(VYLO.global.DiscordUser=DiscordUser)}}grabUserToken(){const code=this.getCode(),xhttp=new XMLHttpRequest,xhrData="client_id=&client_secret=&redirect_uri="+REDIRECT_URI+"&code="+code+"&scope=identify&grant_type=authorization_code";window.history.replaceState(null,null,window.location.pathname),xhttp.open("POST",DISCORD_OAUTH2_TOKEN_BASE_URL,!0),xhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded"),xhttp.send(xhrData),xhttp.onloadend=()=>{const token=JSON.parse(xhttp.responseText);this.grabDiscordUser(token)}}sendUserToServer(){VYLO&&VYLO.Client.sendPacket("dAPI256",JSON.stringify(VYLO.Client.DiscordUser))}}const DiscordHandler=new VYDiscordHandler;window.DiscordHandler=DiscordHandler,VYLO&&(VYLO.global.DiscordHandler=DiscordHandler),DiscordHandler.login()})();